(()=>{"use strict";let e=localStorage.getItem("lang")||"en";const t=document.querySelectorAll(".input-language"),n=document.querySelectorAll(".language"),o={en:{"greeting.morning":"Good morning,","greeting.afternoon":"Good afternoon,","greeting.evening":"Good evening,","greeting.night":"Good night,","placeholder.name":"[Enter your name]","date.language":"en-US","default.city":"Minsk","weather.wind":"Wind speed:","wind.dimension":"m/s","weather.humidity":"Humidity:","settings.language":"Choose language:","settings.en":"English","settings.ru":"Russian","settings.background":"Background:","settings.background.exp":"Take background from","settings.tag":"Tag:","settings.tag.exp":"Set background tag","settings.show.hide":"Show/hide:","show.time":"Time","show.date":"Date","show.greeting":"Greeting","show.quote":"Quote","show.weather":"Weather","show.player":"Player","tag.button":"Apply"},ru:{"greeting.morning":"Доброе утро,","greeting.afternoon":"Добрый день,","greeting.evening":"Добрый вечер,","greeting.night":"Доброй ночи,","placeholder.name":"[Ваше имя]","date.language":"ru-RU","default.city":"Минск","weather.wind":"Скорость ветра:","wind.dimension":"м/с","weather.humidity":"Влажность:","settings.language":"Выберите язык:","settings.en":"Английский","settings.ru":"Русский","settings.background":"Фон:","settings.background.exp":"Источник фонового изображения","settings.tag":"Тег:","settings.tag.exp":"Установить тег для фона","settings.show.hide":"Показать/спрятать:","show.time":"Время","show.date":"Дата","show.greeting":"Приветствие","show.quote":"Цитата","show.weather":"Погода","show.player":"Плеер","tag.button":"Применить"}};function a(t){return o[e][t]}const c=document.querySelector(".greeting"),s=document.querySelector(".name"),r=document.querySelector(".greeting-container");const i=document.querySelector(".time"),l=document.querySelector(".date");function u(){const e=(new Date).toLocaleDateString(a("date.language"),{weekday:"long",month:"long",day:"numeric"});l.textContent=e,setTimeout(u,1e3)}const d=document.querySelectorAll(".input-background"),g=document.querySelector(".input-tag"),m=document.querySelector(".tag-button");function y(){return localStorage.getItem("tag")||k()}let h;const p=document.querySelector(".body"),w=document.querySelector(".slide-next"),S=document.querySelector(".slide-prev");let f=localStorage.getItem("background")||"gitHub",v=Math.floor(20*Math.random())+1,q=v.toString().padStart(2,0);function k(){const e=(new Date).getHours();switch(Math.floor(e/6)){case 1:return"morning";case 2:return"afternoon";case 3:return"evening";case 0:return"night"}}async function L(){const e=new Image;if(f&&"gitHub"!=f)if("flickr"==f){const t=await async function(){if(h)return h;const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=0a3c1aa40332f267905f613aa3ba03a3&tags=${y()}&extras=url_h&format=json&nojsoncallback=1`,t=await fetch(e),n=await t.json();return h=n.photos.photo.map((e=>e.url_h)),h}();e.src=t[+q]}else"unsplash"==f&&(e.src=await async function(){const e=`https://api.unsplash.com/photos/random?orientation=landscape&query=${y()}&client_id=LztCpwZQCzKzCqmYmmepdMAk62i7H1--9jGvFwt0Ua0`,t=await fetch(e);return(await t.json()).urls.full}());else e.src=`https://raw.githubusercontent.com/darya-startsava/stage1-tasks/assets/images/${k()}/${q}.jpg`;e.onload=()=>{p.style.backgroundImage=`url(${e.src})`}}const C=document.querySelector(".weather-icon"),x=document.querySelector(".temperature"),E=document.querySelector(".weather-description"),I=document.querySelector(".wind"),b=document.querySelector(".humidity"),$=document.querySelector(".weather-error"),M=document.querySelector(".city"),T=document.querySelector(".weather");async function A(){const t=`https://api.openweathermap.org/data/2.5/weather?q=${M.value}&lang=${e}&appid=e4f05c638c1d3df262d927daf0594260&units=metric`,n=await fetch(t),o=await n.json();o.name?($.textContent="",C.className="weather-icon owf",C.classList.add(`owf-${o.weather[0].id}`),x.textContent=`${Math.round(o.main.temp)}°C`,E.textContent=o.weather[0].description,I.textContent=`${a("weather.wind")} ${Math.round(o.wind.speed)} ${a("wind.dimension")}`,b.textContent=`${a("weather.humidity")} ${Math.round(o.main.humidity)} %`,localStorage.setItem("city",M.value)):($.textContent="Please, enter correct city",C.className="weather-icon owf",x.textContent="",E.textContent="",I.textContent="",b.textContent="")}function j(){localStorage.getItem("city")&&"Minsk"!=localStorage.getItem("city")&&"Минск"!=localStorage.getItem("city")?M.value=localStorage.getItem("city"):M.value=a("default.city")}const D=document.querySelector(".quote"),G=document.querySelector(".author"),H=document.querySelector(".change-quote"),W=document.querySelector(".quote-and-author");async function P(){const t=`./assets/json/data_${e}.json`,n=await fetch(t),o=await n.json();let a=Math.floor(20*Math.random());D.textContent=`${o.quotes[a].quote}`,G.textContent=`${o.quotes[a].author}`}const Q=[{title:"Aqua Caelestis",src:"./assets/sounds/Aqua Caelestis.mp3",duration:"00:39"},{title:"Ennio Morricone",src:"./assets/sounds/Ennio Morricone.mp3",duration:"01:37"},{title:"River Flows In You",src:"./assets/sounds/River Flows In You.mp3",duration:"01:37"},{title:"Summer Wind",src:"./assets/sounds/Summer Wind.mp3",duration:"01:50"}],_=document.querySelector(".play-button"),R=document.querySelector(".play-prev"),U=document.querySelector(".play-next"),z=document.querySelector(".play-list"),B=document.querySelector(".timeline"),F=document.querySelector(".volume"),Y=document.querySelector(".volume-percentage"),N=document.querySelector(".sound");let X;const K=document.querySelector(".player"),Z=new Audio;let J=!1,O=0;function V(){J=!1,O==Q.length-1?O=0:O+=1,te()}function ee(){const e=document.querySelectorAll(".play-item");e.forEach((e=>{e.classList.remove("item-active"),e.classList.remove("paused-item")})),e[O].classList.add("item-active"),J?e[O].classList.add("paused-item"):e[O].classList.remove("paused-item")}function te(){J?(_.classList.add("play"),_.classList.remove("pause"),J=!1):(_.classList.add("pause"),_.classList.remove("play"),J=!0),J?(Z.src=Q[O].src,Z.play()):Z.pause(),ee()}const ne=document.querySelector(".radiobutton-text"),oe=document.getElementById("english-language"),ae=document.getElementById("russian-language"),ce=document.querySelector(".set-background-text"),se=document.querySelector(".set-background-text-explanation"),re=document.querySelectorAll(".background"),ie=document.querySelector(".input-show-time"),le=document.querySelector(".input-show-date"),ue=document.querySelector(".input-show-greeting"),de=document.querySelector(".input-show-quote"),ge=document.querySelector(".input-show-weather"),me=document.querySelector(".input-show-player"),ye=document.querySelector(".set-tag-text"),he=document.querySelector(".set-tag-text-explanation"),pe=document.querySelector(".show-time-text"),we=document.querySelector(".show-time"),Se=document.querySelector(".show-date"),fe=document.querySelector(".show-greeting"),ve=document.querySelector(".show-quote"),qe=document.querySelector(".show-weather"),ke=document.querySelector(".show-player");let Le,Ce,xe,Ee,Ie,be;const $e=document.querySelector(".button-close"),Me=document.querySelector(".settings-popup"),Te=document.querySelector(".button-settings");function Ae(){ie.checked?(i.style.opacity="1",i.style.transition="opacity .5s",Le="yes"):(i.style.opacity="0",Le="no")}function je(){le.checked?(l.style.opacity="1",l.style.transition="opacity .5s",Ce="yes"):(l.style.opacity="0",Ce="no")}function De(){ue.checked?(r.style.opacity="1",r.style.transition="opacity .5s",xe="yes"):(r.style.opacity="0",xe="no")}function Ge(){de.checked?(W.style.opacity="1",W.style.transition="opacity .5s",Ee="yes"):(W.style.opacity="0",Ee="no")}function He(){ge.checked?(T.style.opacity="1",T.style.transition="opacity .5s",Ie="yes"):(T.style.opacity="0",Ie="no")}function We(){me.checked?(K.style.opacity="1",K.style.transition="opacity .5s",be="yes"):(K.style.opacity="0",be="no")}!function e(){const t=(new Date).toLocaleTimeString("en-US",{hour12:!1});i.textContent=t,u(),c.textContent=function(){const e=(new Date).getHours();switch(Math.floor(e/6)){case 1:return a("greeting.morning");case 2:return a("greeting.afternoon");case 3:return a("greeting.evening");case 0:return a("greeting.night")}}(),s.placeholder=localStorage.getItem("name")||a("placeholder.name"),setTimeout(e,1e3)}(),window.addEventListener("beforeunload",(function(){localStorage.setItem("name",s.value)})),window.addEventListener("load",(function(){localStorage.getItem("name")&&(s.value=localStorage.getItem("name"))})),L(),w.addEventListener("click",(function(){q=20==v?"01":(v+1).toString().padStart(2,0),v=+q,L()})),S.addEventListener("click",(function(){q=1==v?"20":(v-1).toString().padStart(2,0),v=+q,L()})),M.value||j(),A(),M.addEventListener("change",A),window.addEventListener("beforeunload",(function(){localStorage.setItem("city",M.value)})),window.addEventListener("load",j),P(),H.addEventListener("click",P),function(){for(let e=0;e<Q.length;e++){const t=document.createElement("li");t.classList.add("play-item"),t.textContent=`${Q[e].title} | ${Q[e].duration}`,z.append(t)}X=document.querySelectorAll(".play-item")}(),ee(),_.addEventListener("click",te),R.addEventListener("click",(function(){J=!1,0==O?O=Q.length-1:O-=1,te()})),U.addEventListener("click",V),Z.addEventListener("loadeddata",(function(){const e=document.querySelector(".length"),t=document.querySelector(".track-name");e.textContent=`${Q[O].duration}`,t.textContent=`${Q[O].title}`})),Z.addEventListener("timeupdate",(function(){const e=document.querySelector(".current"),t=document.querySelector(".progress");let n=parseInt(Z.currentTime%60),o=parseInt(Z.currentTime/60%60);e.innerHTML=o.toString().padStart(2,0)+":"+n.toString().padStart(2,0),t.style.width=Z.currentTime/Z.duration*100+"%"})),B.addEventListener("click",(function(e){const t=window.getComputedStyle(B).width,n=e.offsetX/parseInt(t)*Z.duration;Z.currentTime=n})),F.addEventListener("click",(function(e){const t=window.getComputedStyle(F).width,n=e.offsetX/parseInt(t);Z.volume=n,Y.style.width=100*n+"%"})),N.addEventListener("click",(function(){Z.volume||!Z.muted?(Z.muted=!0,Z.volume=0,Y.style.width=0,N.classList.remove("sound-on"),N.classList.add("sound-off")):(Z.muted=!1,Z.volume=.5,Y.style.width="50%",N.classList.remove("sound-off"),N.classList.add("sound-on"))})),Z.addEventListener("ended",V),X.forEach(((e,t)=>{e.addEventListener("click",(()=>function(e,t){e.classList.contains("paused-item")?(e.classList.remove("paused-item"),te()):(X.forEach((e=>{e.classList.remove("paused-item")})),e.classList.add("paused-item"),O=t,J=!1,te())}(e,t)))})),t.forEach(((e,t)=>{e.addEventListener("change",(()=>function(e,t){var n;n=e.value,localStorage.setItem("lang",n),location.reload()}(e)))})),window.addEventListener("load",(function(){ne.textContent=a("settings.language"),oe.textContent=a("settings.en"),ae.textContent=a("settings.ru"),n.forEach((e=>{e.classList.remove("language-active")})),"en"==e?n[0].classList.add("language-active"):n[1].classList.add("language-active"),ce.textContent=a("settings.background"),se.textContent=a("settings.background.exp"),re.forEach((e=>{e.classList.remove("background-active")})),"gitHub"==f?re[0].classList.add("background-active"):"unsplash"==f?re[1].classList.add("background-active"):"flickr"==f&&re[2].classList.add("background-active"),ye.textContent=a("settings.tag"),he.textContent=a("settings.tag.exp"),pe.textContent=a("settings.show.hide"),we.textContent=a("show.time"),Se.textContent=a("show.date"),fe.textContent=a("show.greeting"),ve.textContent=a("show.quote"),qe.textContent=a("show.weather"),ke.textContent=a("show.player"),m.textContent=a("tag.button")})),ie.addEventListener("change",Ae),le.addEventListener("change",je),ue.addEventListener("change",De),de.addEventListener("change",Ge),ge.addEventListener("change",He),me.addEventListener("change",We),window.addEventListener("beforeunload",(function(){localStorage.setItem("isTimeChecked",Le),localStorage.setItem("isDateChecked",Ce),localStorage.setItem("isGreetingChecked",xe),localStorage.setItem("isQuoteChecked",Ee),localStorage.setItem("isWeatherChecked",Ie),localStorage.setItem("isPlayerChecked",be)})),window.addEventListener("load",(function(){localStorage.getItem("isTimeChecked")&&"yes"!=localStorage.getItem("isTimeChecked")||ie.click(),Ae(),localStorage.getItem("isDateChecked")&&"yes"!=localStorage.getItem("isDateChecked")||le.click(),je(),localStorage.getItem("isGreetingChecked")&&"yes"!=localStorage.getItem("isGreetingChecked")||ue.click(),De(),localStorage.getItem("isQuoteChecked")&&"yes"!=localStorage.getItem("isQuoteChecked")||de.click(),Ge(),localStorage.getItem("isWeatherChecked")&&"yes"!=localStorage.getItem("isWeatherChecked")||ge.click(),He(),localStorage.getItem("isPlayerChecked")&&"yes"!=localStorage.getItem("isPlayerChecked")||me.click(),We()})),d.forEach((e=>{e.addEventListener("change",(()=>function(e){localStorage.setItem("background",`${e.value}`),location.reload()}(e)))})),m.addEventListener("click",(function(){localStorage.setItem("tag",g.value),location.reload()})),$e.addEventListener("click",(function(){Me.style.display="none",$e.style.display="none"})),Te.addEventListener("click",(function(){Me.style.display="unset",$e.style.display="unset"}))})();